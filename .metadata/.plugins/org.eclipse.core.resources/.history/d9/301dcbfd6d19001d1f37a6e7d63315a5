package cs.yagozk.calculator.impl;

import java.math.BigInteger;
import java.util.*;
import cs.yagozk.calculator.Calculator;
import org.osgi.service.component.annotations.Component;

@Component
public class CalculatorMethods implements Calculator {

	@Override
	public BigInteger add(BigInteger num1, BigInteger num2) {
		return num1.add(num2);
	}

	@Override
	public BigInteger sub(BigInteger num1, BigInteger num2) {
		return num1.subtract(num2);
	}

	@Override
	public BigInteger mul(BigInteger num1, BigInteger num2) {
		return num1.multiply(num2);
	}

	@Override
	public BigInteger div(BigInteger num1, BigInteger num2) {
		return num1.divide(num2);
		// sıfıra bölme şeyini hallet
	}

	@Override
	public BigInteger translateFromTr(String trInput) {

	    List<String> validWords = Arrays.asList
	    	    (
	    	    "sıfır","bir","iki","üç","dört","beş","altı","yedi",
	    	    "sekiz","dokuz","on","yirmi",
	    	    "otuz","kırk","elli","altmış","yetmiş","seksen","doksan",
	    	    "yüz","bin","milyon","milyar","trilyon", "katrilyon", "kentilyon",
	    	    "sekstilyon", "septilyon", "oktilyon", "nonilyon"
	    	    );
	    BigInteger tempResult = BigInteger.ZERO;
	    BigInteger finalResult = BigInteger.ZERO;
	    boolean inputValid = true;
	    
	    if ( trInput != null && trInput.length() > 0 ) {
	    	// Replace "and" and "-" for a whitespace
	    	trInput = trInput.replaceAll("-", " ");
	    	trInput = trInput.toLowerCase().replaceAll( " and", " ");
	    	//Split the input into an array, separated by whitespace
	    	String[] splittedArr = trInput.trim().split("\\s+");
	    	
	    	// Check if the input has any invalid words
	    	for ( String s : splittedArr ) {
	    		if ( !validWords.contains(s) ) {
	    			inputValid = false;
	    			System.out.println("Invalid input, please type correctly");
	    			return null;
	    		}
	    	}
	    	
	    	// if the input is valid, iterate through the input and form the final result as a BigInt
	    	if ( inputValid ) {
	    		for ( String str : splittedArr ) {
	                if(str.equalsIgnoreCase("sıfır"))
	                	tempResult = tempResult.add(BigInteger.ZERO);
	                else if(str.equalsIgnoreCase("bir"))
	                	tempResult = tempResult.add(BigInteger.valueOf(1));
	                else if(str.equalsIgnoreCase("iki"))
	                	tempResult = tempResult.add(BigInteger.valueOf(2));
	                else if(str.equalsIgnoreCase("üç"))
	                	tempResult = tempResult.add(BigInteger.valueOf(3));
	                else if(str.equalsIgnoreCase("dört"))
	                	tempResult = tempResult.add(BigInteger.valueOf(4));
	                else if(str.equalsIgnoreCase("beş"))
	                	tempResult = tempResult.add(BigInteger.valueOf(5));
	                else if(str.equalsIgnoreCase("altı"))
	                	tempResult = tempResult.add(BigInteger.valueOf(6));
	                else if(str.equalsIgnoreCase("yedi"))
	                	tempResult =  tempResult.add(BigInteger.valueOf(7));
	                else if(str.equalsIgnoreCase("sekiz"))
	                	tempResult = tempResult.add(BigInteger.valueOf(8));
	                else if(str.equalsIgnoreCase("dokuz"))
	                	tempResult = tempResult.add(BigInteger.valueOf(9));
	                else if(str.equalsIgnoreCase("on"))
	                	tempResult = tempResult.add(BigInteger.valueOf(10));
	                	               
	                else if(str.equalsIgnoreCase("yirmi"))
	                	tempResult = tempResult.add(BigInteger.valueOf(20));
	                else if(str.equalsIgnoreCase("otuz"))
	                	tempResult = tempResult.add(BigInteger.valueOf(30));
	                else if(str.equalsIgnoreCase("kırk"))
	                	tempResult = tempResult.add(BigInteger.valueOf(40));
	                else if(str.equalsIgnoreCase("elli"))
	                	tempResult = tempResult.add(BigInteger.valueOf(50));
	                else if(str.equalsIgnoreCase("altmış"))
	                	tempResult = tempResult.add(BigInteger.valueOf(60));
	                else if(str.equalsIgnoreCase("yetmiş"))
	                	tempResult = tempResult.add(BigInteger.valueOf(70));
	                else if(str.equalsIgnoreCase("seksen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(80));
	                else if(str.equalsIgnoreCase("doksan"))
	                	tempResult = tempResult.add(BigInteger.valueOf(90));
	                
	                else if(str.equalsIgnoreCase("yüz")) {
	                	if ( tempResult.equals(BigInteger.ZERO) ) {
	                		tempResult = BigInteger.ONE;
	                	}
	                	tempResult = tempResult.multiply(BigInteger.valueOf(100));
	                }
	                else if(str.equalsIgnoreCase("bin")) {
	                	if ( tempResult.equals(BigInteger.ZERO) ) {
	                		tempResult = BigInteger.ONE;
	                	}
	                	tempResult = tempResult.multiply( new BigInteger("1000"));
	                    finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("milyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("milyar")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("trilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("katrilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("kentilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("sekstilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("septilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("oktilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("nonilyon")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	    		}
	    		
	    		finalResult = finalResult.add(tempResult);
	    		tempResult = BigInteger.ZERO;
	    		
	    	}
	    	
	    }
	    

		return finalResult;
	}

	@Override
	public BigInteger translateFromEng(String engInput) {
	    List<String> validWords = Arrays.asList
	    	    (
	    	    "zero","one","two","three","four","five","six","seven",
	    	    "eight","nine","ten","eleven","twelve","thirteen","fourteen",
	    	    "fifteen","sixteen","seventeen","eighteen","nineteen","twenty",
	    	    "thirty","forty","fifty","sixty","seventy","eighty","ninety",
	    	    "hundred","thousand","million","billion","trillion", "quadrillion", "quintillion",
	    	    "sextillion", "septillion", "octillion", "nonillion"
	    	    );
	    BigInteger tempResult = BigInteger.ZERO;
	    BigInteger finalResult = BigInteger.ZERO;
	    boolean inputValid = true;
	    
	    if ( engInput != null && engInput.length() > 0 ) {
	    	// Replace "and" and "-" for a whitespace
	        engInput = engInput.replaceAll("-", " ");
	    	engInput = engInput.toLowerCase().replaceAll( " and", " ");
	    	//Split the input into an array, separated by whitespace
	    	String[] splittedArr = engInput.trim().split("\\s+");
	    	
	    	// Check if the input has any invalid words
	    	for ( String s : splittedArr ) {
	    		if ( !validWords.contains(s) ) {
	    			inputValid = false;
	    			System.out.println("Invalid input, please type correctly");
	    			return null;
	    		}
	    	}
	    	
	    	// if the input is valid, iterate through the input and form the final result as a BigInt
	    	if ( inputValid ) {
	    		for ( String str : splittedArr ) {
	                if(str.equalsIgnoreCase("zero"))
	                	tempResult = tempResult.add(BigInteger.ZERO);
	                else if(str.equalsIgnoreCase("one"))
	                	tempResult = tempResult.add(BigInteger.valueOf(1));
	                else if(str.equalsIgnoreCase("two"))
	                	tempResult = tempResult.add(BigInteger.valueOf(2));
	                else if(str.equalsIgnoreCase("three"))
	                	tempResult = tempResult.add(BigInteger.valueOf(3));
	                else if(str.equalsIgnoreCase("four"))
	                	tempResult = tempResult.add(BigInteger.valueOf(4));
	                else if(str.equalsIgnoreCase("five"))
	                	tempResult = tempResult.add(BigInteger.valueOf(5));
	                else if(str.equalsIgnoreCase("six"))
	                	tempResult = tempResult.add(BigInteger.valueOf(6));
	                else if(str.equalsIgnoreCase("seven"))
	                	tempResult =  tempResult.add(BigInteger.valueOf(7));
	                else if(str.equalsIgnoreCase("eight"))
	                	tempResult = tempResult.add(BigInteger.valueOf(8));
	                else if(str.equalsIgnoreCase("nine"))
	                	tempResult = tempResult.add(BigInteger.valueOf(9));
	                else if(str.equalsIgnoreCase("ten"))
	                	tempResult = tempResult.add(BigInteger.valueOf(10));
	                
	                else if(str.equalsIgnoreCase("eleven"))
	                	tempResult = tempResult.add(BigInteger.valueOf(11));
	                else if(str.equalsIgnoreCase("twelve"))
	                	tempResult = tempResult.add(BigInteger.valueOf(12));
	                else if(str.equalsIgnoreCase("thirteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(13));
	                else if(str.equalsIgnoreCase("fourteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(14));
	                else if(str.equalsIgnoreCase("fifteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(15));
	                else if(str.equalsIgnoreCase("sixteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(16));
	                else if(str.equalsIgnoreCase("seventeen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(17));
	                else if(str.equalsIgnoreCase("eighteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(18));
	                else if(str.equalsIgnoreCase("nineteen"))
	                	tempResult = tempResult.add(BigInteger.valueOf(19));
	               
	                else if(str.equalsIgnoreCase("twenty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(20));
	                else if(str.equalsIgnoreCase("thirty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(30));
	                else if(str.equalsIgnoreCase("forty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(40));
	                else if(str.equalsIgnoreCase("fifty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(50));
	                else if(str.equalsIgnoreCase("sixty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(60));
	                else if(str.equalsIgnoreCase("seventy"))
	                	tempResult = tempResult.add(BigInteger.valueOf(70));
	                else if(str.equalsIgnoreCase("eighty"))
	                	tempResult = tempResult.add(BigInteger.valueOf(80));
	                else if(str.equalsIgnoreCase("ninety"))
	                	tempResult = tempResult.add(BigInteger.valueOf(90));
	                
	                else if(str.equalsIgnoreCase("hundred"))
	                	tempResult = tempResult.multiply(BigInteger.valueOf(100));
	                else if(str.equalsIgnoreCase("thousand")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000"));
	                    finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("million")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("billion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("trillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("quadrillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("quintillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("sextillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("septillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("octillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                else if(str.equalsIgnoreCase("nonillion")) {
	                	tempResult = tempResult.multiply( new BigInteger("1000000000000000000000000000000"));
	                	finalResult = finalResult.add(tempResult);
	                    tempResult = BigInteger.ZERO;
	                }
	                
	                // desilyonu da ekle
	    		}
	    		
	    		finalResult = finalResult.add(tempResult);
	    		tempResult = BigInteger.ZERO;
	    		
	    	}
	    	
	    }
	    

		return finalResult;
	}

}
